// Functions implementing the raycasting algorithm.